# description	: JSON for Modern C++
# depends	: cmake

pkgname=nlohmann-json
pkgver=3.12.0
pkgrel=1
source=($pkgname-$pkgver.tar.gz::https://github.com/nlohmann/json/archive/refs/tags/v$pkgver.tar.gz
        nlohmann_json-3.12.0-fallback-missing-char8_t.patch)

build() {
	cd json-$pkgver

    patch -Np1 -i ../nlohmann_json-3.12.0-fallback-missing-char8_t.patch

    cmake -B build \
        -D CMAKE_INSTALL_PREFIX=/usr \
        -D CMAKE_BUILD_TYPE=None \
        -D BUILD_TESTING=OFF \
        -D CMAKE_INSTALL_LIBDIR=/usr/lib \
        -D JSON_BuildTests=OFF \
        -D JSON_MultipleHeaders=ON
	cmake --build build
    DESTDIR="$pkgdir" cmake --install build
}