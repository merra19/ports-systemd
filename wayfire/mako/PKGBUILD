# description	: A lightweight notification daemon for Wayland. Works on Sway
# depends	: meson scdoc systemd wayland-protocols jq

pkgname=mako
pkgver=1.10.0
pkgrel=1
source=($pkgname-$pkgver.tar.gz::https://github.com/emersion/mako/releases/download/v$pkgver/mako-$pkgver.tar.gz
        systemd-dbus-activation.patch)

build() {
    cd $pkgname-$pkgver

    patch -Np1 -i "$srcdir"/systemd-dbus-activation.patch

    meson setup \
        --prefix=/usr \
        --buildtype=release \
		-D bash-completions=true \
		-D fish-completions=true \
		-D zsh-completions=true \
		-D sd-bus-provider=libsystemd \
		build
	ninja -C build
	DESTDIR="$pkgdir" ninja install -C build

    install -vDm644 -t "$pkgdir"/usr/lib/systemd/user/ contrib/systemd/mako.service
}