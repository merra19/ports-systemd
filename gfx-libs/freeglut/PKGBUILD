# description	: A free OpenGL utility toolkit, the open-sourced alternative to the GLUT library
# depends	: mesa glu cmake

pkgname=freeglut
pkgver=3.6.0
pkgrel=1
source=(https://downloads.sourceforge.net/freeglut/$pkgname-$pkgver.tar.gz)

build() {
	cd $pkgname-$pkgver

	# First, fix a problem when building with gcc-15
	sed -e '/Context/s/()/(SFG_PlatformDisplay, SFG_WindowContextType)/' \
		-i src/egl/fg_init_egl.h

	cmake -B build \
        -D CMAKE_INSTALL_PREFIX=/usr \
		-D CMAKE_BUILD_TYPE=Release \
		-D CMAKE_POLICY_VERSION_MINIMUM=3.5 \
		-D FREEGLUT_BUILD_DEMOS=OFF \
		-D FREEGLUT_BUILD_STATIC_LIBS=OFF \
		-Wno-dev
	make -C build 
    make DESTDIR="$pkgdir" install -C build
}