# description	: Python bindings to Zstandard (zstd) compression library
# depends	: python py3-gpep517 py3-setuptools py3-wheel zstd

pkgname=py3-pyzstd
pkgver=0.17.0
pkgrel=1
source=(https://files.pythonhosted.org/packages/source/p/pyzstd/pyzstd-$pkgver.tar.gz)

build() {
	cd pyzstd-$pkgver
	
	# HACK: workaround upstream setuptools version check specifically for Windows.
	sed -i 's/setuptools>=64,<74/setuptools/' pyproject.toml

	export ZSTD_EXTERNAL="true"

	gpep517 build-wheel --wheel-dir .dist --output-fd 3 3>&1 >&2
	python3 -m installer -d "$pkgdir" .dist/*.whl
}