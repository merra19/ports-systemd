# description	: An assembler for x86 and x86_64 instruction sets
# depends	: glibc py3-cython

pkgname=yasm
pkgver=1.3.0
pkgrel=1
options=(!lto)
source=(https://www.tortall.net/projects/$pkgname/releases/$pkgname-$pkgver.tar.gz)

build() {
	cd $pkgname-$pkgver

	# First, fix a problem when building with gcc-15
	sed -e 's/def __cplusplus/ defined(__cplusplus) || __STDC_VERSION__ >= 202311L/' \
		-i libyasm/bitvect.h

	sed -i 's#) ytasm.*#)#' Makefile.in
    
	./configure \
        --prefix=/usr
	make
    make DESTDIR="$pkgdir" install
}