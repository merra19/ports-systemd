# description	: Cross platform Make
# depends	: glibc gcc libarchive libuv nghttp2 expat zlib ncurses

pkgname=cmake
pkgver=4.1.0
pkgrel=1
source=(https://cmake.org/files/v${pkgver%.*}/$pkgname-$pkgver.tar.gz)

build() {
	cd $pkgname-$pkgver

    sed -i '/"lib64"/s/64//' Modules/GNUInstallDirs.cmake

    scratch isinstalled curl || OPTS_CMAKE='--no-system-curl'

    ./bootstrap \
        --prefix=/usr \
        --mandir=/usr/share/man \
        --system-libs \
        --mandir=/share/man \
        --no-system-jsoncpp \
        --no-system-cppdap \
        --no-system-librhash \
        --parallel=$jobs \
        $OPTS_CMAKE \
        --docdir=/share/doc/$pkgname-$pkgver
    make   
    make DESTDIR="$pkgdir" install
}