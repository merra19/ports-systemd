# description	: Prebuilt Java JDK binaries
# depends	: glibc zlib alsa-lib xorg-libs cups giflib man-db lcms2

pkgname=java
_pkgname=OpenJDK
pkgver=24.0.2
pkgrel=1
options=(!strip)
source=(https://anduin.linuxfromscratch.org/BLFS/OpenJDK/OpenJDK-$pkgver/OpenJDK-$pkgver+12-x86_64-bin.tar.xz
        openjdk.sh java)

build() {
    cd ${_pkgname}-$pkgver+12-x86_64-bin

    install -vdm755 "$pkgdir"/opt/OpenJDK-$pkgver-bin &&
    mv -v * "$pkgdir"/opt/OpenJDK-$pkgver-bin         &&
    chown -R root:root "$pkgdir"/opt/OpenJDK-$pkgver-bin

    ln -sfn OpenJDK-$pkgver-bin "$pkgdir"/opt/jdk

    install -Dm 755 "$srcdir"/openjdk.sh "$pkgdir"/etc/profile.d/openjdk.sh
    install -Dm 644 "$srcdir"/java "$pkgdir"/etc/sudoers.d/java 

    mkdir -p "$pkgdir"/opt/jdk/lib/security
    ln -sfv /etc/pki/tls/java/cacerts "$pkgdir"/opt/jdk/lib/security/cacerts

    mkdir -p "$pkgdir"/var/cache/man
}
