# description	: XSL stylesheets for Docbook-xml transformations
# depends	: libxml2 libxslt zip

pkgname=docbook-xsl-nons
pkgver=1.79.2
pkgrel=1
source=(https://github.com/docbook/xslt10-stylesheets/releases/download/release/$pkgver/$pkgname-$pkgver.tar.bz2
	    https://www.linuxfromscratch.org/patches/blfs/12.4/docbook-xsl-nons-$pkgver-stack_fix-1.patch
        https://github.com/docbook/xslt10-stylesheets/releases/download/release/$pkgver/docbook-xsl-doc-$pkgver.tar.bz2)
noextract=(docbook-xsl-doc-$pkgver.tar.bz2)

build() {
	cd $pkgname-$pkgver

	patch -Np1 -i ../docbook-xsl-nons-$pkgver-stack_fix-1.patch

    tar -xf ../docbook-xsl-doc-$pkgver.tar.bz2 --strip-components=1

    install -v -m755 -d "$pkgdir"/usr/share/xml/docbook/xsl-stylesheets-nons-$pkgver

    cp -v -R VERSION assembly common eclipse epub epub3 extensions fo       \
            highlighting html htmlhelp images javahelp lib manpages params  \
            profiling roundtrip slides template tests tools webhelp website \
            xhtml xhtml-1_1 xhtml5                                          \
        "$pkgdir"/usr/share/xml/docbook/xsl-stylesheets-nons-$pkgver

    ln -s VERSION "$pkgdir"/usr/share/xml/docbook/xsl-stylesheets-nons-$pkgver/VERSION.xsl

    install -v -m755 -d "$pkgdir"/usr/share/doc/docbook-xsl-nons-$pkgver
    install -v -m644 -D README \
                        "$pkgdir"/usr/share/doc/docbook-xsl-nons-$pkgver/README.txt
    install -v -m644    RELEASE-NOTES* NEWS* \
                        "$pkgdir"/usr/share/doc/docbook-xsl-nons-$pkgver

    cp -v -R doc/* "$pkgdir"/usr/share/doc/docbook-xsl-nons-$pkgver
}
