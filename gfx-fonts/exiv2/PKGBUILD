# description	: EXIF, IPTC and XMP metadata C++ library and command line utility
# depends	: curl cmake ninja inih zlib expat brotli

pkgname=exiv2
pkgver=0.28.5
pkgrel=1
source=(https://github.com/Exiv2/exiv2/archive/v$pkgver/$pkgname-$pkgver.tar.gz)

build() {
	cd $pkgname-$pkgver

    if (! scratch isinstalled brotli ); then 
        OPTS_BROTLI="-D EXIV2_ENABLE_BROTLI=no"
    fi

	cmake -B build \
         $OPTS_BROTLI \
        -D CMAKE_INSTALL_PREFIX=/usr \
		-D CMAKE_BUILD_TYPE=release \
		-D EXIV2_ENABLE_VIDEO=yes \
		-D EXIV2_ENABLE_WEBREADY=yes \
		-D EXIV2_ENABLE_CURL=yes \
		-D EXIV2_BUILD_SAMPLES=no \
        -D EXIV2_ENABLE_NLS=no \
		-G "Unix Makefiles"
	make -C build
    make DESTDIR="$pkgdir" install -C build
}