# description	: Encode/decode WOFF2 font format
# depends	: brotli cmake

pkgname=woff2
pkgver=1.0.2
pkgrel=1
source=(https://github.com/google/woff2/archive/v$pkgver/$pkgname-$pkgver.tar.gz)

build() {
    cd $pkgname-$pkgver

    # First, fix a problem when building with gcc-15
    sed -i '/output.h/i #include <cstdint>' src/woff2_out.cc

    cmake -B out \
        -D CMAKE_INSTALL_PREFIX=/usr \
        -D CMAKE_BUILD_TYPE=Release \
        -D CMAKE_POLICY_VERSION_MINIMUM=3.5 \
        -D CMAKE_SKIP_INSTALL_RPATH=ON
    make -C out
	make DESTDIR="$pkgdir" install -C out
}