# description	: A dynamic tiling Wayland compositor that doesn't sacrifice on its looks
# depends	: cmake hyprland-protocols meson ninja xorg-proto cairo
# depends	: aquamarine gcc glib glslang hyprcursor hyprgraphics
# depends	: hyprland-qtutils hyprlang hyprutils hyprwayland-scanner
# depends	: libdisplay-info libdrm libglvnd libinput libliftoff re2
# depends	: libxcb xorg-libs libxkbcommon mesa pango pixman wayland
# depends	: tomlplusplus util-linux wayland-protocols polkit glaze
# depends	: xcb-proto xcb-util xcb-util-errors xcb-utilities seatd
# depends	: xwayland systemd

pkgname=hyprland
pkgver=0.50.1
pkgrel=1
source=($pkgname-$pkgver.tar.gz::https://github.com/hyprwm/Hyprland/releases/download/v$pkgver/source-v$pkgver.tar.gz)

build() {
	cd $pkgname-source

    sed -i -e '/^release:/{n;s/-D/-DCMAKE_SKIP_RPATH=ON -D/}' Makefile

    rm -fv scripts/generateVersion.sh

    make release PREFIX=/usr
    make DESTDIR="$pkgdir" install
    rm -fv "$pkgdir/usr/include/hyprland/src/version.h.in"
    # Drop this line when hyprland-portals.conf is removed from xdg-desktop-portal-hyprland
    rm -frv "$pkgdir/usr/share/xdg-desktop-portal"
}