# description	: Standard EXT2/EXT3/EXT4 filesystem utilities
# depends	: util-linux texinfo

pkgname=e2fsprogs
pkgver=1.47.3
pkgrel=1
source=(https://downloads.sourceforge.net/project/e2fsprogs/e2fsprogs/v$pkgver/$pkgname-$pkgver.tar.gz)
backup=(etc/mke2fs.conf etc/e2scrub.conf)

build() {
    cd $pkgname-$pkgver

    mkdir -v build
    cd       build
    
    ../configure \
        --prefix=/usr \
        --sysconfdir=/etc \
        --disable-fsck \
        --disable-libblkid \
        --disable-uuidd \
        --disable-libuuid \
        --enable-elf-shlibs
    make
    make DESTDIR="$pkgdir" install

    rm -fv "$pkgdir"/usr/lib/{libcom_err,libe2p,libext2fs,libss}.a

    gunzip -v "$pkgdir"/usr/share/info/libext2fs.info.gz
    install-info --dir-file="$pkgdir"/usr/share/info/dir "$pkgdir"/usr/share/info/libext2fs.info

    makeinfo -o  doc/com_err.info ../lib/et/com_err.texinfo
    install -v -m644 doc/com_err.info "$pkgdir"/usr/share/info
    install-info --dir-file="$pkgdir"/usr/share/info/dir "$pkgdir"/usr/share/info/com_err.info
}
