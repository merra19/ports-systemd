# description	: HTTP client/server library for GNOME version 3
# depends	: glib nghttp2 sqlite brotli libpsl zlib libxml2 vala
# depends	: gobject-introspection glib-networking

pkgname=libsoup3
_pkgname=libsoup
pkgver=3.6.5
pkgrel=1
source=(https://download.gnome.org/sources/libsoup/${pkgver%.*}/libsoup-$pkgver.tar.xz)

build() {
	cd ${_pkgname}-$pkgver

	#  Fix the installation path of API documentation
	sed 's/apiversion/soup_version/' -i docs/reference/meson.build
    
	meson setup \
        --prefix=/usr \
        --buildtype=plain \
        -D vapi=enabled \
        -D gssapi="$(scratch isinstalled krb5 && echo "enabled" || echo "disabled")" \
        -D sysprof=disabled \
        --wrap-mode=nofallback \
        build
	ninja -C build
    DESTDIR="$pkgdir" ninja install -C build
}