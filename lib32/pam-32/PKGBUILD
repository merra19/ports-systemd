# description	: Linux-PAM (Pluggable Authentication Modules)
# depends	: libxcrypt-32 libnsl-32 libtirpc-32 pam

pkgname=pam-32
pkgver=1.7.1
pkgrel=1
source=(https://github.com/linux-pam/linux-pam/releases/download/v$pkgver/Linux-PAM-$pkgver.tar.xz)

build() {
    cd Linux-PAM-$pkgver

	export CC="gcc -m32 -mstackrealign"
	export CXX="g++ -m32 -mstackrealign"
	#export PKG_CONFIG_LIBDIR="/usr/lib32/pkgconfig"
    export PKG_CONFIG_PATH='/usr/lib32/pkgconfig'

    meson setup \
        --prefix=/usr \
        --buildtype=plain \
        --libdir=lib32 \
        --cross-file lib32 \
		-D docdir=/usr/share/doc/Linux-PAM-$pkgver \
        build
    ninja -C build
    DESTDIR="$PWD"/DESTDIR ninja install -C build
    mkdir -p "$pkgdir"/usr/lib32
    cp -Rv DESTDIR/usr/lib32/* "$pkgdir"/usr/lib32
}