# description	: The Audio Output library
# depends	: alsa-lib pulseaudio xorg-libs

pkgname=libao
pkgver=1.2.0
pkgrel=1
source=(https://downloads.xiph.org/releases/ao/libao-1.2.0.tar.gz
        libao.conf)
backup=(etc/libao.conf)

build() {
    cd $pkgname-$pkgver

    #  Fix a gcc-14 issue
    sed -i '/limits.h/a #include <time.h>' src/plugins/pulse/ao_pulse.c

    ./configure \
        --prefix=/usr \
        --enable-alsa-mmap
    make
    make DESTDIR="$pkgdir" install
    
    # default config
    install -vDm 644 ../libao.conf -t "$pkgdir/etc/"
}
