# description	: Open codec for interactive speech and music transmission over the Internet
# depends	: glibc

pkgname=opus
pkgver=1.5.2
pkgrel=1
options=(!lto)
source=( https://downloads.xiph.org/releases/opus/$pkgname-$pkgver.tar.gz)

build() {
	cd $pkgname-$pkgver

    if echo "$CFLAGS" | grep -q "\-Ofast"; then

        meson setup \
            --prefix=/usr \
            --buildtype=plain \
            -D intrinsics=enabled \
            -D float-approx=true \
            build
        ninja -C build
    else
        meson setup \
            --prefix=/usr \
            --buildtype=plain \
            build
        ninja -C build
    fi

    DESTDIR="$pkgdir" ninja install -C build
}