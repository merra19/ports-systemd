# description	: Reusable library for GPU-accelerated image processing primitives
# depends	: vulkan-loader lcms2 libglvnd glad shaderc glslang
# depends	: libunwind

pkgname=libplacebo
pkgver=7.351.0
pkgrel=1
source=(https://github.com/haasn/libplacebo/archive/refs/tags/v$pkgver/$pkgname-$pkgver.tar.gz)

build() {
	cd $pkgname-$pkgver

    # First, fix an incompatibility with Python-3.13.6 and later
    sed -e '204a\    tree = ET.parse(xmlfile)' \
        -e 's/VkXML(ET.parse(xmlfile))/VkXML(tree.getroot())/' \
        -i src/vulkan/utils_gen.py

	meson setup \
        --prefix=/usr \
        --buildtype=plain \
        -D tests=true \
        -D demos=false \
        build
	ninja -C build
    DESTDIR="$pkgdir" ninja install -C build
}