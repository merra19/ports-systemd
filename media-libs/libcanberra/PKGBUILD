# description	: Portable sound event library
# depends	: libvorbis alsa-lib systemd pulseaudio wireplumber gtk3
# depends	: sound-theme-freedesktop
# optional  : gstreamer

pkgname=libcanberra
pkgver=0.30
pkgrel=1
options=(!lto)
source=(https://0pointer.de/lennart/projects/libcanberra/$pkgname-$pkgver.tar.xz
        https://www.linuxfromscratch.org/patches/blfs/12.4/$pkgname-$pkgver-wayland-1.patch)

build() {
	cd $pkgname-$pkgver

    scratch isinstalled gtk3 ||  OPT_GTK3='-disable-gtk3'

    # Fix an issue causing some applications to crash in Wayland based desktop environment
    patch -Np1 -i ../$pkgname-$pkgver-wayland-1.patch

    ./configure \
        --prefix=/usr \
        --disable-oss \
        --disable-gtk \
        $OPT_GTK3
    make
    make DESTDIR="$pkgdir" docdir=/usr/share/doc/$pkgname-$pkgver install
}